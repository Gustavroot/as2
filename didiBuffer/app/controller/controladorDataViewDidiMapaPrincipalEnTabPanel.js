/*
 * File: app/controller/controladorDataViewDidiMapaPrincipalEnTabPanel.js
 *
 * This file was generated by Sencha Architect version 2.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.1.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.controladorDataViewDidiMapaPrincipalEnTabPanel', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            dataview: '#dataViewDidiMapaPrincipalEnTabPanel'
        },

        control: {
            "dataview": {
                itemtap: 'onDataviewItemTap'
            }
        }
    },

    onDataviewItemTap: function(dataview, index, target, record, e, options) {


        Ext.getCmp("mapaContainerMapa").setMasked({xtype: 'loadmask', message: 'Espere por favor...'});

        //Esta linea sirve para modificar el PHP que hace el trabajo de devolucion de
        //entradas al store
        Ext.getStore("storeListadoTotalDeLasEmpresas").getProxy().setUrl("http://www.didicr.com/php/cliente/clienteEnMapa.php");
        //Se pasa por parametro la categoria de la cual se desea extraer el listado de las
        //empresas

        //alert(record.get("idCategoria"));

        Ext.getStore("storeListadoTotalDeLasEmpresas").getProxy().setExtraParam('catParam',record.get("idCategoria"));
        //Se introducen markers en el mapa, para esto, se pasa el store del cual se extraeran
        //los campos correspondientes, y se pasa el mapa al cual se le agregaran esos markers
        funcionParaIntroducirMarkersEnMapa("storeListadoTotalDeLasEmpresas",Ext.getCmp("mapaContainerMapa"));

        //Ext.getCmp("containerInfoCategoriaEnMapaPrincipal").setHtml("<center><p style='font-size: 100%;'> Categor√≠a: </p> <p style='font-size: 100%;'> "+record.get("nombre")+" </p></center>");


    }

});