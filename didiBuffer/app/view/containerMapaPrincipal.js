/*
 * File: app/view/containerMapaPrincipal.js
 *
 * This file was generated by Sencha Architect version 2.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.1.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.containerMapaPrincipal', {
    extend: 'Ext.Container',
    alias: 'widget.containerMapaPrincipal',

    requires: [
        'MyApp.view.mapaContainerMapa'
    ],

    config: {
        id: 'containerMapaPrincipal',
        itemId: 'containerMapaPrincipal',
        layout: {
            type: 'fit'
        },
        items: [
            {
                xtype: 'mapacontainermapa'
            },
            {
                xtype: 'toolbar',
                border: 0,
                docked: 'top',
                height: '10%',
                id: 'toolbarMapaContainerMapa',
                style: 'background: #3E3737',
                items: [
                    {
                        xtype: 'image',
                        centered: true,
                        height: '100%',
                        html: '<img src="./resources/logo/Logo_DD.png" width="100%" height="100%">',
                        id: 'imagenLogoDidiMapaPrincipalEnTabPanel',
                        itemId: 'myimage27',
                        left: '30%',
                        width: '40%'
                    },
                    {
                        xtype: 'button',
                        handler: function(button, event) {
                            //Primero se hace visible el tabBar nuevamente
                            Ext.getCmp("tabPanelPrincipal").getTabBar().setHidden(0);
                            //Luego, si se viene del tab de containerMapa, entonces quiere decir que ahi
                            //se tomo la decision de cual mapa se queria ver, y se prefiere retornar al
                            //containerInicio que a ahi
                            if(tabDelQueSePasaHaciaTabMapa==Ext.getCmp("containerMapa")){
                                Ext.getCmp("tabPanelPrincipal").setActiveItem(Ext.getCmp("containerInicio"));
                            }
                            else{
                                Ext.getCmp("tabPanelPrincipal").setActiveItem(tabDelQueSePasaHaciaTabMapa);
                            }


                            directionsDisplay.setMap(null);


                        },
                        baseCls: 'botonAtras',
                        height: '80%',
                        id: 'botonAtrasDidiMapaPrincipalEnTabPanel',
                        right: '2%',
                        top: '10%',
                        ui: 'action-round',
                        width: '15%'
                    },
                    {
                        xtype: 'button',
                        handler: function(button, event) {
                            //Con este codigo se permite que el mapa se vuelva a centrar en la posicion
                            //actual propia
                            if (navigator.geolocation) {
                                navigator.geolocation.getCurrentPosition(
                                function(position){
                                    //Se crea un objeto de posicion, con latitud y longitud actuales
                                    posActual = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                                    Ext.getCmp("mapaContainerMapa").setMapCenter({latitude: posActual.lat(), longitude: posActual.lng()});
                                }
                                );
                            }


                        },
                        height: '80%',
                        id: 'botonVolverPosActualMapaPrincipal',
                        left: '2%',
                        top: '10%',
                        ui: 'confirm-round',
                        width: '15%',
                        text: '<p style="font-size: 40%;"> Ir a pos </p> <p style="font-size: 40%;"> actual </p>'
                    }
                ]
            }
        ],
        listeners: [
            {
                fn: 'onImagenLogoDidiMapaPrincipalEnTabPanelTap',
                event: 'tap',
                delegate: '#imagenLogoDidiMapaPrincipalEnTabPanel'
            }
        ]
    },

    onImagenLogoDidiMapaPrincipalEnTabPanelTap: function(img, e, options) {
        //TOdo logo de DIdi redirige hacia containerInicio
        Ext.getCmp("tabPanelPrincipal").setActiveItem(Ext.getCmp("containerInicio"));
        //Al salir del mapa, hay que hacer visible el tabBar nuevamente
        Ext.getCmp("tabPanelPrincipal").getTabBar().setHidden(0);
    }

});